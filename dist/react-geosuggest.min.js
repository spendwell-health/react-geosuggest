!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Geosuggest=e()}}(function(){return function e(t,s,i){function o(n,g){if(!s[n]){if(!t[n]){var a="function"==typeof require&&require;if(!g&&a)return a(n,!0);if(u)return u(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var c=s[n]={exports:{}};t[n][0].call(c.exports,function(e){var s=t[n][1][e];return o(s?s:e)},c,c.exports,e,t,s,i)}return s[n].exports}for(var u="function"==typeof require&&require,n=0;n<i.length;n++)o(i[n]);return o}({1:[function(e,t){"use strict";var s=e("react"),i=e("./GeosuggestItem"),o=s.createClass({displayName:"Geosuggest",getDefaultProps:function(){return{fixtures:[],initialValue:"",placeholder:"Search places",className:"",onSuggestSelect:function(){},location:null,radius:0,defaultIconClass:"",googleMaps:google&&google.maps}},propTypes:{initialLocation:s.PropTypes.object},getInitialState:function(){return{isSuggestsHidden:!0,userInput:this.props.initialValue,lastSuggest:{label:this.props.initialValue,location:this.props.initialLocation},mouseHoveredSuggest:null,activeSuggest:null,suggests:[],geocoder:new this.props.googleMaps.Geocoder,autocompleteService:new this.props.googleMaps.places.AutocompleteService}},onInputChange:function(){var e=this.refs.geosuggestInput.getDOMNode().value;this.setState({userInput:e},function(){this.showSuggests()}.bind(this))},searchSuggests:function(){return this.state.userInput?void this.state.autocompleteService.getPlacePredictions({input:this.state.userInput,location:this.props.location||new this.props.googleMaps.LatLng(0,0),radius:this.props.radius,componentRestrictions:{country:"usa"}},function(e){this.updateSuggests(e)}.bind(this)):void this.updateSuggests()},updateSuggests:function(e){e||(e=[]);{var t=[];new RegExp(this.state.userInput,"gim")}this.props.fixtures.forEach(function(e){e.placeId=e.label,t.push(e)}),e.forEach(function(e){t.push({label:e.description.replace(", United States",""),placeId:e.place_id})}),this.setState({suggests:t})},showSuggests:function(){this.searchSuggests(),this.setState({isSuggestsHidden:!1})},hideSuggests:function(){setTimeout(function(){this.setState({isSuggestsHidden:!0})}.bind(this),100)},onInputKeyDown:function(e){switch(e.which){case 40:e.preventDefault(),this.activateSuggest("next");break;case 38:e.preventDefault(),this.activateSuggest("prev");break;case 13:this.selectSuggest(this.state.activeSuggest);break;case 9:this.selectSuggest(this.state.activeSuggest);break;case 27:this.hideSuggests()}},activateSuggest:function(e){if(this.state.isSuggestsHidden)return void this.showSuggests();var t=this.state.suggests.length-1,s="next"===e,i=null,o=0,u=0;for(u;t>=u;u++)this.state.suggests[u]===this.state.activeSuggest&&(o=s?u+1:u-1);this.state.activeSuggest||(o=s?0:t),o>=0&&t>=o&&(i=this.state.suggests[o]),this.setState({activeSuggest:i})},selectSuggest:function(e){return e||(e=this.state.userInput&&this.state.suggests.length-this.props.fixtures.length>0?this.state.suggests[this.props.fixtures.length]:this.state.lastSuggest||{}),this.setState({isSuggestsHidden:!0,userInput:e.label,lastSuggest:e}),e.location?void this.props.onSuggestSelect(e):void this.geocodeSuggest(e)},setMouseHoveredSuggest:function(e){this.setState({mouseHoveredSuggest:e})},geocodeSuggest:function(e){this.state.geocoder.geocode({address:e.label},function(t,s){if(s===this.props.googleMaps.GeocoderStatus.OK){var i=t[0],o=i.geometry.location;e.gmaps=i,e.location={lat:o.lat(),lng:o.lng()},this.props.onSuggestSelect(e)}}.bind(this))},onBlur:function(e){e.stopPropagation(),e.preventDefault(),this.selectSuggest(this.state.mouseHoveredSuggest),this.hideSuggests()},onFocus:function(e){e.stopPropagation(),e.preventDefault(),this.setState({userInput:""}),this.showSuggests()},render:function(){return s.createElement("div",{className:"geosuggest "+this.props.className,onClick:this.onClick},s.createElement("input",{className:"geosuggest__input",ref:"geosuggestInput",type:"text",value:this.state.userInput,placeholder:this.props.placeholder,onKeyDown:this.onInputKeyDown,onChange:this.onInputChange,onFocus:this.onFocus,onBlur:this.onBlur}),s.createElement("ul",{className:this.getSuggestsClasses()},this.getSuggestItems()))},getSuggestItems:function(){var e=this;return this.state.suggests.map(function(t){var o=this.state.activeSuggest&&t.placeId===this.state.activeSuggest.placeId;return s.createElement(i,{key:t.placeId,suggest:t,isActive:o,onSuggestSelect:this.selectSuggest,setMouseHoveredSuggest:e.setMouseHoveredSuggest,classDecorations:this.itemClassDecorations(t)})}.bind(this))},itemClassDecorations:function(e){var t=this.props.fixtures,s="";return t.length>0&&(s+=t.indexOf(e)+1===t.length?" geosuggest-item-last-fixture":""),s+=e.iconClass?" "+e.iconClass:" "+this.props.defaultIconClass},getSuggestsClasses:function(){var e="geosuggest__suggests";return e+=this.state.isSuggestsHidden?" geosuggest__suggests--hidden":""}});t.exports=o},{"./GeosuggestItem":2,react:void 0}],2:[function(e,t){"use strict";var s=e("react"),i=s.createClass({displayName:"GeosuggestItem",propTypes:{setMouseHoveredSuggest:s.PropTypes.func.isRequired},getDefaultProps:function(){return{isActive:!1,suggest:{label:"",iconClass:""},onSuggestSelect:function(){}}},handleMouseEnter:function(e){var t=JSON.parse(e.target.getAttribute("data-suggest"));this.props.setMouseHoveredSuggest(t)},handleMouseLeave:function(){this.props.setMouseHoveredSuggest(null)},render:function(){return s.createElement("li",{className:this.getSuggestClasses(),"data-suggest":JSON.stringify(this.props.suggest),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},this.props.suggest.label)},getSuggestClasses:function(){var e="geosuggest-item";return e+=this.props.isActive?" geosuggest-item--active":"",e+=this.props.classDecorations?" "+this.props.classDecorations:""}});t.exports=i},{react:void 0}]},{},[1])(1)});